{"ast":null,"code":"import React,{useState}from\"react\";import{Chess}from\"chess.js\";import{Chessboard}from\"react-chessboard\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function App(){const[game,setGame]=useState(new Chess());const[history,setHistory]=useState([]);const[gameOver,setGameOver]=useState(false);function safeGameMutate(modify){const updated=new Chess(game.fen());modify(updated);setGame(updated);setHistory(updated.history());// keeps full history\nif(updated.isGameOver())setGameOver(true);}async function onDrop(sourceSquare,targetSquare){if(gameOver)return false;let move=null;safeGameMutate(g=>{move=g.move({from:sourceSquare,to:targetSquare,promotion:\"q\"});});if(move===null)return false;// ✅ Only request AI move if it's now Black's turn\nif(game.turn()===\"b\"&&!game.isGameOver()){await getAIMove();}return true;}async function getAIMove(){try{const response=await fetch(\"/api/ai-move\",{method:\"POST\",headers:{\"Content-Type\":\"application/json\"},body:JSON.stringify({fen:game.fen()})});const data=await response.json();if(data.move){safeGameMutate(g=>{g.move({from:data.move.from,to:data.move.to,promotion:data.move.promotion||\"q\"});});}else{console.warn(\"AI did not return a move\",data);}}catch(error){console.error(\"Error fetching AI move:\",error);}}function newGame(){const freshGame=new Chess();setGame(freshGame);setHistory([]);setGameOver(false);}return/*#__PURE__*/_jsxs(\"div\",{style:{backgroundColor:\"#3c9959\",height:\"100vh\",padding:\"20px\"},children:[/*#__PURE__*/_jsx(\"h1\",{style:{color:\"white\"},children:\"Chess AI App\"}),/*#__PURE__*/_jsx(\"button\",{onClick:newGame,children:\"New Game\"}),/*#__PURE__*/_jsxs(\"div\",{style:{display:\"flex\",marginTop:\"20px\"},children:[/*#__PURE__*/_jsx(Chessboard,{position:game.fen(),onPieceDrop:onDrop,boardWidth:500}),/*#__PURE__*/_jsxs(\"div\",{style:{marginLeft:\"20px\",color:\"white\"},children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Move History\"}),/*#__PURE__*/_jsx(\"ol\",{children:history.map((move,i)=>/*#__PURE__*/_jsx(\"li\",{children:move},i))}),gameOver&&/*#__PURE__*/_jsx(\"h2\",{children:\"Game Over\"})]})]})]});}export default App;","map":{"version":3,"names":["React","useState","Chess","Chessboard","jsx","_jsx","jsxs","_jsxs","App","game","setGame","history","setHistory","gameOver","setGameOver","safeGameMutate","modify","updated","fen","isGameOver","onDrop","sourceSquare","targetSquare","move","g","from","to","promotion","turn","getAIMove","response","fetch","method","headers","body","JSON","stringify","data","json","console","warn","error","newGame","freshGame","style","backgroundColor","height","padding","children","color","onClick","display","marginTop","position","onPieceDrop","boardWidth","marginLeft","map","i"],"sources":["/Users/fadiluddin/Projects/chess-ai-app/frontend/src/App.js"],"sourcesContent":["import React, { useState } from \"react\";\nimport { Chess } from \"chess.js\";\nimport { Chessboard } from \"react-chessboard\";\n\nfunction App() {\n  const [game, setGame] = useState(new Chess());\n  const [history, setHistory] = useState([]);\n  const [gameOver, setGameOver] = useState(false);\n\n  function safeGameMutate(modify) {\n    const updated = new Chess(game.fen());\n    modify(updated);\n    setGame(updated);\n    setHistory(updated.history()); // keeps full history\n    if (updated.isGameOver()) setGameOver(true);\n  }\n\n  async function onDrop(sourceSquare, targetSquare) {\n    if (gameOver) return false;\n\n    let move = null;\n    safeGameMutate((g) => {\n      move = g.move({\n        from: sourceSquare,\n        to: targetSquare,\n        promotion: \"q\",\n      });\n    });\n\n    if (move === null) return false;\n\n    // ✅ Only request AI move if it's now Black's turn\n    if (game.turn() === \"b\" && !game.isGameOver()) {\n      await getAIMove();\n    }\n\n    return true;\n  }\n\n  async function getAIMove() {\n    try {\n      const response = await fetch(\"/api/ai-move\", {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify({ fen: game.fen() }),\n      });\n      const data = await response.json();\n\n      if (data.move) {\n        safeGameMutate((g) => {\n          g.move({\n            from: data.move.from,\n            to: data.move.to,\n            promotion: data.move.promotion || \"q\",\n          });\n        });\n      } else {\n        console.warn(\"AI did not return a move\", data);\n      }\n    } catch (error) {\n      console.error(\"Error fetching AI move:\", error);\n    }\n  }\n\n  function newGame() {\n    const freshGame = new Chess();\n    setGame(freshGame);\n    setHistory([]);\n    setGameOver(false);\n  }\n\n  return (\n    <div style={{ backgroundColor: \"#3c9959\", height: \"100vh\", padding: \"20px\" }}>\n      <h1 style={{ color: \"white\" }}>Chess AI App</h1>\n      <button onClick={newGame}>New Game</button>\n      <div style={{ display: \"flex\", marginTop: \"20px\" }}>\n        <Chessboard\n          position={game.fen()}\n          onPieceDrop={onDrop}\n          boardWidth={500}\n        />\n        <div style={{ marginLeft: \"20px\", color: \"white\" }}>\n          <h3>Move History</h3>\n          <ol>\n            {history.map((move, i) => (\n              <li key={i}>{move}</li>\n            ))}\n          </ol>\n          {gameOver && <h2>Game Over</h2>}\n        </div>\n      </div>\n    </div>\n  );\n}\n\nexport default App;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}